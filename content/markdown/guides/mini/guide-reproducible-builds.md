title: Guide to Configuring for Reproducible Builds
author: Herv√© Boutemy
date: 2019-11-03

<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
## Configuring for Reproducible Builds


### What are Reproducible Builds?


 [Reproducible builds](https://reproducible-builds.org/) are a set of software development practices that create an independently-verifiable path from source to binary code. A build is **reproducible** if given the same source code, build environment and build instructions, any party can recreate **bit-by-bit** identical copies of all specified artifacts.


 [Reproducible Central](https://github.com/jvm-repo-rebuild/reproducible-central) lists projects releases that have been checked as reproducible by rebuilding independently from the reference build published in Central Repository.



### How do I configure my Maven build?


 There is no Maven version prerequisite. Everything happens at plugin level:



 1 Upgrade your plugins to reproducible versions: to easily detect [required upgrades](/plugins/maven-artifact-plugin/plugin-issues.html), run

```
mvn artifact:check-buildplan
```


 1 Enable Reproducible Builds mode for plugins, by adding [`project.build.outputTimestamp` property](https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=74682318#Reproducible/VerifiableBuilds-OutputArchiveEntriesTimestamp) to the project's `pom.xml`:

```
   <properties>
     <project.build.outputTimestamp>2023-01-01T00:00:00Z</project.build.outputTimestamp>
   </properties>
```



 You have the basics configured. The output should be mostly reproducible now.



### How to test my Maven build reproducibility?


 Using [`maven-artifact-plugin`'s `compare` goal](/plugins/maven-artifact-plugin/compare-mojo.html), you can check that the second build of your project produce the same output than an initial build:



 1 build and `install` your project (don't hesitate to customize arguments to better match your project):

```
mvn clean install 
```


 1 rebuild (`verify` only, without installing) and check against the previous install:

```
mvn clean verify artifact:compare
```




### How to fix my Maven build reproducibility?


 If something is still not reproducible after initial setup and [automatic check from `artifact:check-buildplan`](/plugins/maven-artifact-plugin/plugin-issues.html):



 1 Use [diffoscope](https://diffoscope.org/) to find the unstable output between builds. The `artifact:buildinfo` goal proposes a command with path to files: just copy/paste to launch.

 1 Find the plugin that generated this output.

 1 Check if a reproducible version of the plugin is available. If not, please open an issue to help plugin maintainers improving Reproducible Builds support at every plugin level.



### More Details


 Reproducible Builds for Maven:



 - Require **no version ranges** in dependencies,

 - Generally give **different results on Windows and Unix** because of different newlines. (carriage return linefeed on Windows, linefeed on Unixes)

 - Generally depend on the **major version of the JDK** used to compile. (Even with source/target defined, each major JDK version changes the generated bytecode)


 For detailed explanations, see [Maven "Reproducible/Verifiable Builds" Wiki page](https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=74682318).



### FAQ



 - Q. Can the `project.build.outputTimestamp` property in `pom.xml` be updated automatically at release time?

   A. Yes.



   Details depend on your release process tooling:



  - if you use [maven-release-plugin](/plugins/maven-release-plugin/), you'll need **version 3.0.0-M1 or later**: it will automatically update the timestamp value in `pom.xml` during the release in the same commit that updates version,

  - if you have a custom release process tooling, you'll need to add the feature to your release tooling. Notice that if you're using `versions-maven-plugin` in custom release scripts, starting with release 2.9.0, [`versions:set` goal updates the property](https://github.com/mojohaus/versions-maven-plugin/issues/453).

  - instead of explicitely writing a timestamp in their `pom.xml`, some people tend to prefer using last Git commit timestamp, like `$\{git.commit.time\}` from [git-commit-id-maven-plugin](https://github.com/git-commit-id/git-commit-id-maven-plugin).




 Don't hesitate to share your questions or solutions on [user mailing-list](/mailing-lists.html).



 - Q. Which additional plugins need to be updated for Reproducible Builds?

   A. Here is a simplified list:


|**plugin**|**minimum version**|**comments**|
|---|---|---|
|[maven-assembly-plugin](/plugins/maven-assembly-plugin/)|3.2.0||
|[maven-jar-plugin](/plugins/maven-jar-plugin/)|3.2.0||
|[maven-ejb-plugin](/plugins/maven-ejb-plugin/)|3.1.0||
|[maven-javadoc-plugin](/plugins/maven-javadoc-plugin/)|3.2.0|requires also `<notimestamp>true</notimestamp>` configuration in `pluginManagement` (for automatic use both from plugins and reports)|
|[maven-plugin-plugin](/plugin-tools/maven-plugin-plugin/)|3.5.1||
|[maven-remote-resources-plugin](/plugins/maven-remote-resources-plugin/)|1.7.0||
|[maven-shade-plugin](/plugins/maven-shade-plugin/)|3.2.3||
|[maven-site-plugin](/plugins/maven-site-plugin/)|3.9.0||
|[maven-source-plugin](/plugins/maven-source-plugin/)|3.2.1||
|[maven-war-plugin](/plugins/maven-war-plugin/)|3.3.1||
|[maven-ear-plugin](/plugins/maven-ear-plugin/)|3.1.0||
|[plexus-component-metadata](https://codehaus-plexus.github.io/plexus-containers/plexus-component-metadata/)|2.1.0||
|[bnd-maven-plugin](https://github.com/bndtools/bnd/tree/master/maven-plugins/bnd-maven-plugin)||see [documentation](https://github.com/bndtools/bnd/tree/master/maven-plugins/bnd-maven-plugin#reproducible-builds)|
|Apache Felix [maven-bundle-plugin](https://felix.apache.org/documentation/subprojects/apache-felix-maven-bundle-plugin-bnd.html)|5.1.3||
|Eclipse [Sisu Maven Plugin](https://www.eclipse.org/sisu/docs/api/org.eclipse.sisu.mojos/)|0.3.4||
|[springboot-maven-plugin](https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/)||not reproducible|
|MojoHaus [properties-maven-plugin](https://www.mojohaus.org/properties-maven-plugin/)|1.1.0||


   For more details, see [Maven "Reproducible/Verifiable Builds" Wiki page](https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=74682318#Reproducible/VerifiableBuilds-Whataretheissuestosolve?)





